<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset='utf-8'>
    <style>
      svg {
        background: rgba(0, 0, 0, 0.2);
      }
      rect {
        stroke: black;
        fill-opacity: 0.8;
      }
    </style>
  </head>
  <body>

    <svg viewBox="0 0 640 320" style="width:100%"></svg>

    <script src="node_modules/d3fc/node_modules/d3/d3.js"></script>

    <script>
      (function(global) {

        global.barSeries = function() {

          var xScale = d3.scale.identity(),
            yScale = d3.scale.identity(),
            barHeight = 1;

          var barSeries = function(selection) {

            selection.each(function(data) {

              var container = d3.select(this);

              var updateSelection = container.selectAll('rect')
                .data(data);

              updateSelection.enter()
                .append('rect');

              var fillColor = d3.scale.category10();

              updateSelection.attr({
                'x': 0,
                'y': function(d, i) { return yScale(i); },
                'width': function(d, i) { return xScale(d); },
                'height': barHeight,
                'fill': function(d, i) { return fillColor(i); }
              });

              updateSelection.exit()
                .remove();

            });

          };

          barSeries.xScale = function(value) {
            if (!arguments.length) {
              return xScale;
            }
            xScale = value;
            return barSeries;
          };
          barSeries.yScale = function(value) {
            if (!arguments.length) {
              return yScale;
            }
            yScale = value;
            return barSeries;
          };
          barSeries.barHeight = function(value) {
            if (!arguments.length) {
              return barHeight;
            }
            barHeight = value;
            return barSeries;
          };

          return barSeries;
        };

      })(window);
    </script>

    <script>
      (function(global) {

        var data = [18, 15, 20, 22, 23, 10];

        global._data = data;

        var container = d3.select('svg');

        var WIDTH = 640, HEIGHT = 320;

        function render() {

          var xScale = d3.scale.linear()
            .range([0, WIDTH])
            .domain([0, 25]);

          var yScale = d3.scale.linear()
            .range([0, HEIGHT])
            .domain([0, data.length]);

          var barHeight = HEIGHT / data.length;

          var series = barSeries()
            .xScale(xScale)
            .yScale(yScale)
            .barHeight(barHeight);

          container.datum(data)
            .call(series);

          requestAnimationFrame(render);
        }

        requestAnimationFrame(render);

      })(window);
    </script>

  </body>
</html>
